name: opencode-review

on:
  pull_request:
    types: [opened, synchronize, reopened, ready_for_review]

jobs:
  review:
    runs-on: ubuntu-latest
    permissions:
      id-token: write
      contents: read
      pull-requests: read
      issues: read
    steps:
      - uses: actions/checkout@v6
        with:
          persist-credentials: false
      - uses: anomalyco/opencode/github@latest
        env:
          # OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
          GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
        with:
          # openrouter/qwen/qwen3-coder:free
          # groq/llama-3.3-70b-versatile
          model: ${{ secrets.MODEL }}

          prompt: |
            請以繁體中文完整審查這個 Pull Request 中的變更：
            - 檢查程式碼品質
            - 提出可能的潛在錯誤或邏輯問題
            - 給出改善建議與風險注意事項
            請用繁體中文回答，結構化整理回覆。

          # Review this pull request:
          #   - Check for code quality issues
          #   - Look for potential bugs
          #   - Suggest improvements
